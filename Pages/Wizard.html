<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top" />
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <?!= include("Includes/css/bootstrap-5.inc"); ?>
    <?!= include("Includes/css/mraa.inc"); ?>
    <style>
        .progress-line {
            position: absolute;
            top: 0;
            left: 0;
            height: 1px;
            background-color: rgb(63, 111, 243);
        }
    </style>
    <title>MRAA Exhibit Call For Entries Wizard</title>
</head>

<body>
    <?!= include("Includes/html/header.inc"); ?>

    <div class="container" style="background-color: white;">

        <div class="row mt-5">
            <div class="col">
                <ul class="nav nav-pills nav-fill mb-1" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link fs-4 active" id="pills-artist-info-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-artist-info" type="button" role="tab" aria-controls="pills-home"
                            aria-selected="true"><i class="bi bi-person-circle"></i>&nbsp;Artist Info</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link fs-4" id="pills-pay-fees-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-pay-fees" type="button" role="tab" aria-controls="pills-pay-fees"
                            aria-selected="false"><i class="bi bi-credit-card"></i>
                            &nbsp;Pay Fees</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link fs-4" id="pills-upload-images-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-upload-images" type="button" role="tab"
                            aria-controls="pills-upload-images" aria-selected="false"><i
                                class="bi bi-cloud-arrow-up"></i>
                            &nbsp;Upload Images</button>
                    </li>
                </ul>
                <div class="progress mb-3 gx-0">
                    <div id="progressBar" class="progress-bar progress-bar-striped text-end" style="width: 33%;"
                        role="progressbar" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-artist-info" role="tabpanel"
                        aria-labelledby="pills-artist-info-tab">
                        <form id="frmMain">
                            <div>
                                <h2 class="fs-4">Artist Name *</h2>
                                <div class="input-group mb-3">
                                    <span class="input-group-text" id="firstNameLabel">First Name</span>
                                    <input type="text" class="form-control" id="firstName" aria-label="firstNameLabel"
                                        required />
                                    <div class="invalid-feedback">First name is required</div>
                                    <span class="input-group-text" id="lastNameLabel">Last Name</span>
                                    <input type="text" class="form-control" id="lastName" aria-label="lastNameLabel"
                                        required />
                                    <div class="invalid-feedback">Last name is required</div>
                                </div>
                            </div>

                            <h2 class="fs-4">Contact Information *</h2> <span id="memberStatus" class="badge"></span>
                            <div class="input-group mb-3">
                                <span class="input-group-text" id="emailAddressLabel">Email</span>
                                <input type="email" class="form-control" id="emailAddress"
                                    aria-label="emailAddressLabel" placeholder="Enter a valid email address" required />

                                <span class="input-group-text" id="phoneLabel">Phone</span>
                                <input type="tel" class="form-control" id="phoneNumber" aria-label="phoneLabel"
                                    required />
                            </div>


                        </form>
                        <div class="row mb-3">
                            <div class="col-12">
                                <!-- Buttons -->
                                <hr>
                                <div>
                                    <button class="btn btn-primary mraa-button-primary me-3"
                                        id="btnNextPay">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="pills-pay-fees" role="tabpanel" aria-labelledby="pills-pay-fees-tab">
                        <form action="https://www.paypal.com/cgi-bin/webscr" method="POST" target="_top">
                            <div class="content">
                                <div class="container mt-4 mb-2">
                                    <div class="row text-center">
                                        <div class="tab-content" id="payFee">
                                            <form action="https://www.paypal.com/cgi-bin/webscr" method="POST"
                                                target="_top">
                                                <div class="content">
                                                    <div class="container mt-4 mb-2">
                                                        <div class="row text-center">

                                                            <div id="smart-button-container">
                                                                <div class="col"></div>
                                                                <div class="col">
                                                                    <header class="h1">
                                                                        Pay with PayPal
                                                                    </header>
                                                                    <div class="mb-4">
                                                                        <p>Select Number of Works to Exhibit</p>

                                                                        <select style="visibility: hidden"
                                                                            id="quantitySelect">
                                                                            <option value="1">1</option>
                                                                            <option value="2">2</option>
                                                                        </select>
                                                                        <select id="item-options">
                                                                            <option value="Per Item" price="10">Each
                                                                                Item $10</option>
                                                                        </select>
                                                                    </div>
                                                                    <div id="paypal-button-container"></div>
                                                                </div>
                                                            </div>
                                                            <div class="col"></div>

                                                        </div>


                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="row mb-3">
                            <div class="col-12">
                                <!-- Buttons -->
                                <hr>
                                <div>
                                    <button class="btn btn-primary mraa-button-primary me-3"
                                        id="btnPrevArtist">Previous</button>
                                    <button class="btn btn-primary mraa-button-primary me-3"
                                        id="btnNextUpload">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Upload Images Tab Content -->
                    <div class="tab-pane fade" id="pills-upload-images" role="tabpanel"
                        aria-labelledby="pills-upload-images-tab">
                        <div class="row">
                            <div class="col-6">
                                <div class="mraa-callout mraa-callout-info">
                                    <h2 class="fs-4">Select Your Images to Upload</h2>
                                    <div class="row mb-2">
                                        <div class="col-8"><strong>Limit of <span id="maxPerArtist">Loading...</span>
                                                uploads per
                                                Artist</strong></div>
                                        <div class="col-4 text-right">All fields required *</div>
                                    </div>
                                    <div class="form-group mb-3">
                                        <input accept="image/jpeg, image/png" type="file" id="imageFile"
                                            class="form-control-file" required onchange="showThumbnail(event)">
                                    </div>
                                    <div class="bigger"><strong>You have uploaded <span id="submitsByArtist"
                                                class="badge bg-warning badge-bigger">0</span>
                                            images.</strong></div>
                                </div>
                                <!-- Title -->
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Title of Work</span>
                                    </div>
                                    <input type="text" class="form-control" id="titleOfWork" aria-label="Title of Work"
                                        required />
                                </div>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Width (in)</span>
                                    </div>
                                    <input type="number" class="form-control" id="sizeWidth"
                                        aria-label="Size: Width (in)" min="1" max="999" required />
                                    <div class="input-group-prepend ml-3">
                                        <span class="input-group-text">Height (in)</span>
                                    </div>
                                    <input type="number" class="form-control" id="sizeHeight"
                                        aria-label="Size: Height (in)" min="1" max="999" required />
                                </div>
                                <div class="fs-6 mb-3"><strong>Size should include the frame if artwork is
                                        framed</strong></div>
                                <!-- Medium -->
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Medium</span>
                                    </div>
                                    <input type="text" class="form-control" id="medium" aria-label="Medium" required />
                                </div>
                                <!-- Price -->
                                <div>
                                    <label for="price">Price *</label>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <div>
                                            <input type="number" class="form-control"
                                                aria-label="Amount (to the nearest dollar)" id="price" size="10"
                                                required />
                                        </div>
                                        <div class="input-group-append">
                                            <span class="input-group-text">.00</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <!-- Thumbnail -->
                                <div id="thumbnail-outer-box" class="mraa-highlight p-3 mt-2">
                                    <h2 class="fs-4">Preview Area</h2>
                                    <div id="thumbnail-message" class="text-muted small m-3">
                                        <p>Once you have chosen an image to upload, it
                                            will appear here for you to preview before sending to MRAA.</p>
                                        <p>
                                            <strong class="mraa-important">IMPORTANT</strong>
                                        </p>
                                        <p>
                                            Your registration is <span class="mraa-important">NOT</span> saved
                                            until you fill out all required fields and press the <strong>Upload
                                                Image</strong> button.
                                        </p>
                                        <p>Click the <strong>Finish</strong> button after all images
                                            have been uploaded.</p>
                                    </div>
                                    <div class="mraa-thumbnail-container" id="thumbnail-container"
                                        style="display: none;">
                                        <img class="mraa-thumbnail" id="thumbnail" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-12">
                                <!-- Buttons -->
                                <hr>
                                <div>
                                    <button class="btn btn-primary mraa-button-primary me-5" data-id="test"
                                        data-name="test" data-folder="18T43wf3JH0c4DAYxOAvNE7lEBfvjKfMS"
                                        id="btnSave">Upload
                                        Image</button>
                                    <button class="btn btn-primary mraa-button-primary ms-5"
                                        id="btnPrevPay">Previous</button>
                                    <a class="btn btn-secondary mraa-button-secondary ms-3"
                                        href="<?= ScriptApp.getService().getUrl(); ?>?v=done" id="btnDone"
                                        target="_top">Finish</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <?!= include("Includes/html/footer.inc"); ?>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous">
    </script>

    <script src="https://www.paypal.com/sdk/js?client-id=sb&enable-funding=venmo&currency=USD"
        data-sdk-integration-source="button-factory"></script>
    <script>
        function initPayPalButton() {
            var shipping = 0;
            var itemOptions = document.querySelector("#smart-button-container #item-options");
            var quantity = parseInt(2);
            var quantitySelect = document.querySelector("#smart-button-container #quantitySelect");
            if (!isNaN(quantity)) {
                quantitySelect.style.visibility = "visible";
            }
            var orderDescription = 'Select Number of Works to Exhibit';
            if (orderDescription === '') {
                orderDescription = 'Item';
            }
            paypal.Buttons({
                style: {
                    shape: 'rect',
                    color: 'gold',
                    layout: 'vertical',
                    label: 'pay',

                },
                createOrder: function (data, actions) {
                    var selectedItemDescription = itemOptions.options[itemOptions.selectedIndex].value;
                    var selectedItemPrice = parseFloat(itemOptions.options[itemOptions.selectedIndex]
                        .getAttribute("price"));
                    var tax = (0 === 0) ? 0 : (selectedItemPrice * (parseFloat(0) / 100));
                    if (quantitySelect.options.length > 0) {
                        quantity = parseInt(quantitySelect.options[quantitySelect.selectedIndex].value);
                    } else {
                        quantity = 1;
                    }

                    tax *= quantity;
                    tax = Math.round(tax * 100) / 100;
                    var priceTotal = quantity * selectedItemPrice + parseFloat(shipping) + tax;
                    priceTotal = Math.round(priceTotal * 100) / 100;
                    var itemTotalValue = Math.round((selectedItemPrice * quantity) * 100) / 100;

                    return actions.order.create({
                        purchase_units: [{
                            description: orderDescription,
                            amount: {
                                currency_code: 'USD',
                                value: priceTotal,
                                breakdown: {
                                    item_total: {
                                        currency_code: 'USD',
                                        value: itemTotalValue,
                                    },
                                    shipping: {
                                        currency_code: 'USD',
                                        value: shipping,
                                    },
                                    tax_total: {
                                        currency_code: 'USD',
                                        value: tax,
                                    }
                                }
                            },
                            items: [{
                                name: selectedItemDescription,
                                unit_amount: {
                                    currency_code: 'USD',
                                    value: selectedItemPrice,
                                },
                                quantity: quantity
                            }]
                        }]
                    });
                },
                onApprove: function (data, actions) {
                    return actions.order.capture().then(function (details) {
                        alert('Transaction completed by ' + details.payer.name.given_name +
                            '!');
                    });
                },
                onError: function (err) {
                    console.log(err);
                },
            }).render('#paypal-button-container');
        }
        initPayPalButton();
    </script>
    <script>
        let payTab = document.getElementById("pills-pay-fees-tab");
        let btnNextPay = document.getElementById("btnNextPay");
        payTab.addEventListener("click", function (e) {
            setProgressBar("67%");
        });
        btnNextPay.addEventListener("click", function (e) {
            let thisTab = new bootstrap.Tab(payTab);
            thisTab.show();
            setProgressBar("67%");
        });

        let btnPrevArtist = document.getElementById("btnPrevArtist");
        btnPrevArtist.addEventListener("click", function (e) {
            let thisTab = new bootstrap.Tab(artistTab);
            thisTab.show();
            setProgressBar("33%");
        });

        let artistTab = document.getElementById("pills-artist-info-tab");
        artistTab.addEventListener("click", function (e) {
            let progressBar = document.getElementById("progressBar");
            progressBar.style.width = "33%";
        });

        let btnPrevPay = document.getElementById("btnPrevPay");
        btnPrevPay.addEventListener("click", function (e) {
            let thisTab = new bootstrap.Tab(payTab);
            thisTab.show();
            setProgressBar("67%");
        });

        let uploadTab = document.getElementById("pills-upload-images-tab");
        let btnNextUpload = document.getElementById("btnNextUpload");
        uploadTab.addEventListener("click", function (e) {
            document.getElementById("progressBar").style.width = "100%";
        });
        btnNextUpload.addEventListener("click", function (e) {
            let thisTab = new bootstrap.Tab(uploadTab);
            thisTab.show();
            setProgressBar("100%");
        })

        function setProgressBar(size) {
            let progressBar = document.getElementById("progressBar");
            progressBar.style.width = size;
        }
    </script>
</body>

</html>